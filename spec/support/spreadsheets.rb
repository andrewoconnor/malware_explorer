module Spreadsheets
  def valid_rows
    <<-eos.gsub(/^[\s\t]*/, '')
    MD5,ClassificationName,ClassificationType,Size,FileType
    0x962B49E6E03493E7C2C65ABDE0A26F90,Downloader,trojan,6604,exe
    0x8C494881AD677D531320B6E42566C66B,Windows,clean,176128,exe
    0x08507D36FFF750ED5C921F23EFA03137,Windows,clean,2161,dll
    eos
  end

  def rows_missing_columns
    <<-eos.gsub(/^[\s\t]*/, '')
    MD5,ClassificationName
    0x962B49E6E03493E7C2C65ABDE0A26F90,Downloader
    0x8C494881AD677D531320B6E42566C66B,Windows
    0x08507D36FFF750ED5C921F23EFA03137,Windows
    eos
  end

  def test_csv(rows)
    csv = Tempfile.new(['test_csv', '.csv'])
    csv.write(rows)
    csv.rewind
    Rack::Test::UploadedFile.new(csv, 'text/csv')
  end

  def valid_csv
    test_csv(valid_rows)
  end

  def csv_missing_columns
    test_csv(rows_missing_columns)
  end
end
