class MalwareImportsController < ApplicationController

  def new
    @malware_import = MalwareImport.new
  end

  def create
    import = MalwareImports::ImportMalware.new(permitted_params[:spreadsheet])
    import.perform
    if import.success?
      redirect_to malware_index_path, notice: 'Successfully imported malware'
    else
      redirect_to new_malware_import_path,
                  alert: import.errors.full_messages.to_sentence
    end
  end

  private

  def permitted_params
    params.require(:malware_import).permit(:spreadsheet)
  end
end
